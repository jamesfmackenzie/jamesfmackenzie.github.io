<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Use Plex to Stream Almost Any Video From PC to Xbox One</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Tech, Programming, Agile, Software Engineering, Software, Hardware, Science, Video Games">
    <link rel="canonical" href="http://www.jamesfmackenzie.com/using-plex-to-stream-almost-any-video-from-pc-to-xbox-one">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">

    <!-- Custom CSS & Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link rel="stylesheet" href="/style.css">

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="/css/font-awesome/css/font-awesome.min.css">
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

    <body id="page-top" class="index">
       <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">jamesfmackenzie</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
	    <!-- Header -->
    <header>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <!--<img class="img-responsive" src="../img/projects/" alt="">-->
                    <div class="intro-text">
                        <span class="name">Use Plex to Stream Almost Any Video From PC to Xbox One</span>
                        <hr class="star-light">
                        <span class="skills">Apr 9, 2014</span>
                    </div>
                </div>
            </div>
        </div>
    </header>
	<section id="posts">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 text-center">
					<h2></h2>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-12">
					<p>Last time, <a href="/plex-to-the-rescue/">I suggested we could use Plex Media Server to stream almost any video from PC to Xbox One</a>. Here’s how to actually do it.</p>

<h3 id="install-plex">Install Plex</h3>

<p>I won’t go into great detail on this since it’s already <a href="https://plexapp.zendesk.com/hc/en-us/articles/200380843-Overview">documented on the Plex website</a>, but here’s how to setup Plex Media Server:</p>

<ol>
  <li><a href="https://plex.tv/downloads">Download Plex Media Server</a>.</li>
  <li><a href="https://plexapp.zendesk.com/hc/en-us/articles/200288586-Installation">Install it on your PC</a>.</li>
  <li><a href="http://localhost:32400/web/index.html#!/dashboard">Open the Plex Media Manager</a>.</li>
  <li><a href="https://plexapp.zendesk.com/hc/en-us/articles/200288926-Creating-Libraries">Set up a media library</a>, pointing it to the Videos folder on your PC.</li>
  <li>Turn on DLNA via <code>Settings -&gt; Plex Media Server -&gt; DLNA -&gt; DLNA enabled</code>:</li>
</ol>

<p><img src="/img/posts/2014_03_17_21_01_27_Plex_Web.png" alt="Turning on Plex DLNA" /></p>

<h3 id="create-a-windows-dlna-media-profile">Create a Windows DLNA media profile</h3>

<p>Create a new file called <code>Windows DLNA.xml</code> with the content below. Save it in <code>C:\Program Files (x86)\Plex\Plex Media Server\Resources\Profiles</code>.</p>

<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Client name="Windows DLNA"&gt;
  &lt;!-- Save as Windows DLNA.xml in C:\Program Files (x86)\Plex\Plex Media Server\Resources\Profiles --&gt;
  &lt;Identification&gt;
      &lt;!-- Uniquely identify Windows 8 DLNA client via User-Agent --&gt;
      &lt;Header name="User-Agent" substring="Microsoft-DLNA DLNADOC" /&gt;
    &lt;/Identification&gt;
  &lt;TranscodeTargets&gt;
    &lt;VideoProfile protocol="http" container="mpegts" codec="h264" audioCodec="aac,ac3,eac3" context="streaming"&gt;
      &lt;Setting name="VideoEncodeFlags" value="-x264opts cabac=0" /&gt;
      &lt;Setting name="SubtitleSize" value="100" /&gt;
    &lt;/VideoProfile&gt;
    &lt;VideoProfile protocol="slss" container="mp4" codec="h264" audioCodec="aac" context="streaming"&gt;
      &lt;Setting name="VideoEncodeFlags" value="-x264opts cabac=0:keyint=50:min_keyint=50:scenecut=0" /&gt;
      &lt;Setting name="SubtitleSize" value="100" /&gt;
      &lt;Setting name="AudioSyncFlags" value="3" /&gt;
    &lt;/VideoProfile&gt;
    &lt;VideoProfile protocol="hls" container="mpegts" codec="h264" audioCodec="aac" context="streaming"&gt;
      &lt;Setting name="VideoEncodeFlags" value="-x264opts cabac=1:level=41" /&gt;
      &lt;Setting name="SubtitleSize" value="100" /&gt;
    &lt;/VideoProfile&gt;
    &lt;VideoProfile container="mp4" codec="h264" audioCodec="aac,ac3,eac3" context="static" /&gt;
    &lt;MusicProfile container="mp3" codec="mp3" /&gt;
    &lt;PhotoProfile container="jpeg" /&gt;
  &lt;/TranscodeTargets&gt;
  &lt;DirectPlayProfiles&gt;
    &lt;!-- Notice no .mkv in here. This means it will always be transcoded instead of being sent to the Windows 8 client directly --&gt;
    &lt;VideoProfile container="mp4,mov" codec="h264,mpeg4" audioCodec="aac,ac3,eac3,mp3,pcm" /&gt;
    &lt;VideoProfile container="mpegts" codec="h264" audioCodec="aac,ac3,eac3,mp3,mp2,pcm" /&gt;
    &lt;VideoProfile container="asf" codec="wmv2,wmv3,vc1" audioCodec="wmav2,wmapro,wmavoice" /&gt;
    &lt;VideoProfile container="avi" codec="mpeg4,msmpeg4,mjpeg" audioCodec="mp3,ac3,eac3,mp2,pcm" /&gt;
    &lt;MusicProfile container="asf" codec="wmav2,wmapro,wmavoice" /&gt;
    &lt;MusicProfile container="mp4" codec="aac" /&gt;
    &lt;MusicProfile container="mp3" codec="mp3" /&gt;
    &lt;PhotoProfile container="jpeg" /&gt;
  &lt;/DirectPlayProfiles&gt;
  &lt;CodecProfiles&gt;
    &lt;VideoAudioCodec name="aac,eac3"&gt;
      &lt;Limitations&gt;
        &lt;UpperBound name="audio.channels" value="8" /&gt;
      &lt;/Limitations&gt;
    &lt;/VideoAudioCodec&gt;
    &lt;VideoAudioCodec name="ac3"&gt;
      &lt;Limitations&gt;
        &lt;UpperBound name="audio.channels" value="6" /&gt;
      &lt;/Limitations&gt;
    &lt;/VideoAudioCodec&gt;
  &lt;/CodecProfiles&gt;
  &lt;TranscodeTargetProfiles&gt;
    &lt;VideoTranscodeTarget protocol="*" context="all"&gt;
      &lt;VideoCodec name="*"&gt;
        &lt;Limitations&gt;
          &lt;!-- Windows doesn't appear to play 10-bit h264 --&gt;
          &lt;UpperBound name="video.bitDepth" value="8" isRequired="false" /&gt;
        &lt;/Limitations&gt;
      &lt;/VideoCodec&gt;
    &lt;/VideoTranscodeTarget&gt;
  &lt;/TranscodeTargetProfiles&gt;
&lt;/Client&gt;
</code></pre>

<h3 id="create-an-xbox-one-dlna-media-profile">Create an Xbox One DLNA media profile</h3>

<p>Create another new file called <code>Xbox One.xml</code> with the content below. Save it in <code>C:\Program Files (x86)\Plex\Plex Media Server\Resources\Profiles</code>.</p>

<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Client name="Xbox One"&gt;
  &lt;!-- Save as Xbox One.xml in C:\Program Files (x86)\Plex\Plex Media Server\Resources\Profiles --&gt;
  &lt;!-- Note: this profile is heavily based on the Xbox 360 profile. There's likely room for improvement here --&gt;
  &lt;Identification&gt;
    &lt;Header name="User-Agent" substring="NSPlayer" /&gt;
  &lt;/Identification&gt;
  &lt;DeviceDescription&gt;
    &lt;ModelName&gt;Windows Media Player Sharing&lt;/ModelName&gt;
    &lt;ModelNumber&gt;12.0&lt;/ModelNumber&gt;
    &lt;ModelUrl&gt;http://www.microsoft.com/&lt;/ModelUrl&gt;
    &lt;Manufacturer&gt;Microsoft Corporation&lt;/Manufacturer&gt;
    &lt;ManufacturerUrl&gt;http://www.microsoft.com/&lt;/ManufacturerUrl&gt;
    &lt;X-DlnaDoc&gt;DMS-1.50&lt;/X-DlnaDoc&gt;
    &lt;X-DlnaCap /&gt;
  &lt;/DeviceDescription&gt;
  &lt;TranscodeTargets&gt;
    &lt;VideoProfile container="mpegts" codec="h264" audioCodec="ac3"&gt;
    &lt;/VideoProfile&gt;
    &lt;MusicProfile container="mp3" codec="mp3" /&gt;
    &lt;PhotoProfile container="jpeg" /&gt;
  &lt;/TranscodeTargets&gt;
  &lt;DirectPlayProfiles&gt;
    &lt;VideoProfile container="mpegts" codec="h264" audioCodec="ac3" /&gt;
    &lt;VideoProfile container="avi" codec="mpeg4" audioCodec="ac3,mp3" /&gt;
    &lt;VideoProfile container="avi" codec="h264" audioCodec="aac" /&gt;
    &lt;VideoProfile container="mp4,mov" codec="h264,mpeg4" audioCodec="aac,ac3" /&gt;
    &lt;VideoProfile container="asf" codec="wmv2,wmv3,vc1" audioCodec="wmav2,wmapro" /&gt;
    &lt;MusicProfile container="asf" codec="wmav2,wmapro,wmavoice" /&gt;
    &lt;MusicProfile container="mp3" codec="mp3" /&gt;
    &lt;PhotoProfile container="jpeg" /&gt;
  &lt;/DirectPlayProfiles&gt;
  &lt;CodecProfiles&gt;
    &lt;VideoCodec name="mpeg4"&gt;
      &lt;Limitations&gt;
        &lt;UpperBound name="video.frameRate" value="30" isRequired="false" /&gt;
        &lt;UpperBound name="video.bitrate" value="5120" isRequired="false" /&gt;
      &lt;/Limitations&gt;
    &lt;/VideoCodec&gt;
    &lt;VideoCodec name="h264"&gt;
      &lt;Limitations&gt;
        &lt;UpperBound name="video.width" value="1920" /&gt;
        &lt;UpperBound name="video.height" value="1080" /&gt;
      &lt;/Limitations&gt;
    &lt;/VideoCodec&gt;
    &lt;VideoCodec name="wmv2,wmv3,vc1"&gt;
      &lt;Limitations&gt;
        &lt;UpperBound name="video.width" value="1920" /&gt;
        &lt;UpperBound name="video.height" value="1080" /&gt;
        &lt;!-- FPS upper bound takes care of requirement that advanced profile level be &lt;= 3 --&gt;
        &lt;UpperBound name="video.frameRate" value="30" isRequired="false" /&gt;
        &lt;UpperBound name="video.bitrate" value="15360" isRequired="false" /&gt;
      &lt;/Limitations&gt;
    &lt;/VideoCodec&gt;
    &lt;VideoAudioCodec name="ac3,wmav2,wmapro"&gt;
      &lt;Limitations&gt;
        &lt;UpperBound name="audio.channels" value="6" isRequired="false" /&gt;
      &lt;/Limitations&gt;
    &lt;/VideoAudioCodec&gt;
    &lt;VideoAudioCodec name="aac"&gt;
      &lt;Limitations&gt;
        &lt;UpperBound name="audio.channels" value="2" isRequired="false" /&gt;
        &lt;Match name="audio.profile" value="lc" isRequired="false" /&gt;
      &lt;/Limitations&gt;
    &lt;/VideoAudioCodec&gt;
  &lt;/CodecProfiles&gt;
  &lt;ContainerProfiles&gt;
    &lt;VideoContainer name="mp4,mov"&gt;
      &lt;Limitations&gt;
        &lt;!-- Microsoft doesn't document this, but it appears to be true --&gt;
        &lt;Match name="part.has64bitOffsets" value="0" isRequired="false" /&gt;
      &lt;/Limitations&gt;
    &lt;/VideoContainer&gt;
  &lt;/ContainerProfiles&gt;
  &lt;DlnaMediaProfiles&gt;
    &lt;DlnaVideoProfile container="avi" mimeType="video/avi" /&gt;
  &lt;/DlnaMediaProfiles&gt;
&lt;/Client&gt;
</code></pre>

<h3 id="restart-plex">Restart Plex</h3>

<ol>
  <li>Shut down Plex Media Server (you can find the icon in your Task Tray).</li>
  <li>Restart Plex Media Server from your Start Menu / Start Screen.</li>
</ol>

<h3 id="stream-your-content">Stream your content!</h3>

<p>After restarting Plex, you should see a “Plex Media Server” icon in Windows Explorer:</p>

<p><img src="/img/posts/2014_03_17_20_24_56_This_PC.png" alt="Plex Explorer icon" /></p>

<p>If you can’t see it, you might need to:</p>

<ol>
  <li>Open Windows Explorer.</li>
  <li>Navigate to <code>Computer -&gt; Access Media</code>.</li>
  <li>Click on <code>Connect to a media server</code>:</li>
</ol>

<p><img src="/img/posts/2014_03_17_22_19_41_This_PC-1.png" alt="Connect to a media server" /></p>

<p>One the icon appears, find your content and stream it to your One:</p>

<p><img src="/img/posts/2014_03_18_00_35_32_Wonders_of_the_Solar_System.png" alt="playtomkv" /></p>

<p><img src="/img/posts/tv.jpg" alt="Xbox One Play To with mkv" /></p>

<p>Easy!</p>

<h3 id="what-about-subtitles">What about subtitles?</h3>

<p>Enabling subtitles is pretty easy. Whilst on the PC:</p>

<ol>
  <li>Open the <a href="http://localhost:32400/web/index.html#!/dashboard">Plex Media Manager</a>.</li>
  <li>Find the show you want to enable subtitles for, hit the drop-down next to “SUBTITLES” and make a language selection:</li>
</ol>

<p><img src="/img/posts/2014_03_19_19_16_36_Plex_Web.png" alt="Enabling subtitles" /></p>

<p>That’s it! The subtitles will be rendered next time you Play To.</p>

<h3 id="how-does-it-work">How does it work?</h3>

<p>If you’re interested, here’s how it works.</p>

<ul>
  <li>The Windows DLNA profile ensures that Plex only sends the Windows DLNA client file formats it supports Play To for. Any unsupported file formats will be converted to supported ones on-the-fly.</li>
</ul>

<p>In the logfile extract below, Plex detects that Windows 8 doesn’t support  <code>mkv/h264/aac</code> and remuxes (converts) it:</p>

<pre><code>**[From %localappdata%\Plex Media Server\Logs\Plex DLNA Server.log]**
Mar 17, 2014 21:36:28:973 [7484] DEBUG - Mapped client to profile Windows DLNA using header User-Agent: Microsoft-Windows/6.3 UPnP/1.0 Microsoft-DLNA DLNADOC/1.50
Mar 17, 2014 21:36:35:097 [9048] DEBUG - MDE: E26 - World of Dreams: mkv/h264/aac is not a directplay video profile
Mar 17, 2014 21:36:35:097 [9048] DEBUG - MDE: remuxing h264 video stream
Mar 17, 2014 21:36:35:097 [9048] DEBUG - MDE: remuxing aac audio stream
</code></pre>

<ul>
  <li>The Xbox One profile ensures that Plex only send the One file formats it can successfully stream. Again, unsupported formats are converted on the fly.</li>
</ul>

<p>In the logfile extract below, Plex detects the Xbox One client ensures any unsupported video is converted before being sent:</p>

<pre><code>**[From %localappdata%\Plex Media Server\Logs\Plex DLNA Server.log]**
Mar 17, 2014 22:07:41:030 [6120] DEBUG - Mapped client to profile Xbox One using header User-Agent: NSPlayer/12.00.9600.16411 WMFSDK/12.00.9600.16411
</code></pre>

<p>That’s it!</p>

				</div>
			</div>
		</div>
	</section>
        <!-- Footer -->
    <footer class="text-center">
        <div class="footer-above">
            <div class="container">
                <div class="row">
                    <div class="footer-col col-md-4">
                        <h3></h3>
                        <p>
                            
                        </p>
                    </div>
                    <div class="footer-col col-md-4">
                        <h3>Social</h3>
                        <ul class="list-inline">
                            
                            <li>
                                <a href="http://twitter.com/jamesfmackenzie" class="btn-social btn-outline"><i class="fa fa-fw fa-twitter"></i></a>
                            </li>
		                    
                            <li>
                                <a href="http://stackoverflow.com/users/4958467/jamesfmackenzie" class="btn-social btn-outline"><i class="fa fa-fw fa-stack-overflow"></i></a>
                            </li>
		                    
                            <li>
                                <a href="http://github.com/jamesfmackenzie" class="btn-social btn-outline"><i class="fa fa-fw fa-github"></i></a>
                            </li>
		                    
                        </ul>
                    </div>
                    <div class="footer-col col-md-4">
                        <h3></h3>
                        <p></p>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; James Mackenzie 2015
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-top page-scroll visible-xs visible-sm">
        <a class="btn btn-primary" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

     <!-- jQuery Version 1.11.0 -->
    <script src="/js/jquery-1.11.0.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="/js/jquery.easing.min.js"></script>
    <script src="/js/classie.js"></script>
    <script src="/js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="/js/jqBootstrapValidation.js"></script>
    
    <script src="/js/contact_me_static.js"></script>
    

    <!-- Custom Theme JavaScript -->
    <script src="/js/freelancer.js"></script>

    </body>
</html>